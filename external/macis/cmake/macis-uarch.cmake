if(DEFINED MACIS_UARCH)
  message(STATUS "Using user-defined uarch: ${MACIS_UARCH}")
  # If compiler ID is not GNU or Clang, we cannot use -march flag, so we will not set MACIS_UARCH_FLAGS
  if(NOT (CMAKE_CXX_COMPILER_ID STREQUAL "GNU" OR CMAKE_CXX_COMPILER_ID STREQUAL "Clang"))
    message(WARNING "Compiler ${CMAKE_CXX_COMPILER_ID} does not support -march flag. MACIS_UARCH_FLAGS will not be set.")
    set(MACIS_UARCH_USED "NONE" CACHE STRING "User-defined microarchitecture for optimization")
  else()
    set(MACIS_UARCH_USED ${MACIS_UARCH} CACHE STRING "User-defined microarchitecture for optimization")
    set(MACIS_UARCH_FLAGS "-march=${MACIS_UARCH}" CACHE STRING "Compiler flags for user-defined microarchitecture")
  endif()
else()
  message(WARNING "MACIS_UARCH not defined. This may degrade performance")
  set(MACIS_UARCH_USED "NONE" CACHE STRING "User-defined microarchitecture for optimization")
endif()
